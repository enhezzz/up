(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["book"],{"0a0d":function(t,e,a){t.exports=a("e829")},"0a49":function(t,e,a){var n=a("9b43"),i=a("626a"),s=a("4bf8"),o=a("9def"),r=a("cd1c");t.exports=function(t,e){var a=1==t,c=2==t,d=3==t,l=4==t,u=6==t,f=5==t||u,_=e||r;return function(e,r,m){for(var v,g,p=s(e),h=i(p),y=n(r,m,3),b=o(h.length),w=0,C=a?_(e,b):c?_(e,0):void 0;b>w;w++)if((f||w in h)&&(v=h[w],g=y(v,w,p),t))if(a)C[w]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return w;case 2:C.push(v)}else if(l)return!1;return u?-1:d||l?l:C}}},"0f2f":function(t,e,a){},1169:function(t,e,a){var n=a("2d95");t.exports=Array.isArray||function(t){return"Array"==n(t)}},"13a6":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"swiper"},[t._t("options"),a("div",{staticClass:"swiper-items"},[t._t("sliderBox")],2)],2)},i=[],s={},o=s,r=(a("c4dc"),a("2877")),c=Object(r["a"])(o,n,i,!1,null,"6c719494",null);e["a"]=c.exports},"1f29":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search-container"},[a("i",{staticClass:"search-icon"}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],staticClass:"search-input",attrs:{type:"text",placeholder:t.placeholder},domProps:{value:t.query},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)},input:function(e){e.target.composing||(t.query=e.target.value)}}})])},i=[],s=a("0a0d"),o=a.n(s),r={name:"SearchBox",props:{placeholder:{type:String,default:"搜索书本名称"}},data:function(){return{query:"",prevTime:o()(),nowTime:o()(),interval:null}},created:function(){this.query=localStorage.searchKeyword||""},mounted:function(){var t=this;this.interval=setInterval(function(){t.nowTime+=1e3},1e3)},beforeDestroy:function(){clearInterval(this.interval)},methods:{search:function(){this.nowTime-this.prevTime<=1e3||(this.prevTime=this.nowTime,this.$emit("search",this.query))}}},c=r,d=(a("6750"),a("2877")),l=Object(d["a"])(c,n,i,!1,null,"9df24cde",null);e["a"]=l.exports},"2f37":function(t,e,a){var n=a("63b6");n(n.S,"Date",{now:function(){return(new Date).getTime()}})},"4fd7":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"nothing"},[a("div",[a("div",{staticClass:"icon"}),a("div",{staticClass:"tips"},[t._v("\n      没有相关信息呀(●ˇ∀ˇ●)\n    ")])])])}],s={name:"Nothing"},o=s,r=(a("9357"),a("2877")),c=Object(r["a"])(o,n,i,!1,null,"61cc9284",null);e["a"]=c.exports},5185:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"book"},[a("SearchBox",{attrs:{placeholder:"搜索书本名称"},on:{search:t.search}}),a("Swiper",{staticClass:"book-list",scopedSlots:t._u([{key:"options",fn:function(){return[a("div",{staticClass:"options"},t._l(t.data.data,function(e,n){return a("div",{key:e.goods_type,class:["option",{actived:t.currentIndex==n}],attrs:{"data-index":n},on:{click:t.toggleType}},[t._v("\n          "+t._s(e["goods_type_name"])+"\n        ")])}),0)]},proxy:!0},{key:"sliderBox",fn:function(){return[a("div",{staticClass:"slider-box",style:{width:0===t.data.total?"100%":100*t.data.total+"%",transform:0===t.data.total?"translateX(0)":"translateX("+-t.currentIndex*(100/t.data.total)+"%)"}},[a("Nothing",{directives:[{name:"show",rawName:"v-show",value:0===t.data.total,expression:"data.total === 0"}]}),t._l(t.data.data,function(e){return a("div",{key:e.goods_type,staticClass:"swiper-item",style:{width:100/t.data.total+"%"}},[a("div",{staticClass:"list"},[a("div",{staticClass:"list-inner"},t._l(e.data,function(e){return a("BorrowItem",{key:e.goods_id,attrs:{"list-item":e},on:{borrow:t._borrow}})}),1)])])})],2)]},proxy:!0}])}),a("div",{class:["mask",{actived:t.maskActived}]},[a("div",{staticClass:"msg-box"},[a("div",{staticClass:"title"},[t._v("\n        请于"+t._s(t.returnTime)+"天内归还:)\n      ")]),a("div",{staticClass:"options"},[a("div",{staticClass:"option cancel",on:{click:t.cancel}},[t._v("\n          取消\n        ")]),a("div",{staticClass:"option borrow",on:{click:t.borrow}},[t._v("\n          借用\n        ")])])])])],1)},i=[],s=(a("7514"),a("96cf"),a("3b8d")),o=a("f499"),r=a.n(o),c=a("1f29"),d=a("13a6"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list-item"},[a("div",{staticClass:"material-icon",style:{backgroundImage:"url("+t.listItem.img_path+")"}}),a("div",{staticClass:"material-info"},[a("div",{staticClass:"item name"},[a("span",[t._v(t._s(t.listItem.goods_name))])]),a("div",{staticClass:"item stats"},[a("div",{staticClass:"num"},[t._v("\n        库存:"+t._s(t.listItem.remaining_stock)+t._s(t.listItem.unit)+"\n      ")]),a("div",{staticClass:"location"},[t._v("\n        楼层:"+t._s(t.listItem.floor_name)+"\n      ")])])]),a("div",{staticClass:"material-options"},[0!==t.listItem.remaining_stock?a("div",{staticClass:"button borrow",on:{click:t.borrow}},[t._v("\n      借用\n    ")]):t._e(),a("router-link",{staticClass:"button check",attrs:{to:"/book/detail?goods_id="+t.listItem.goods_id,tag:"div"}},[t._v("\n      查看\n    ")])],1)])},u=[],f={name:"BorrowItem",props:{listItem:{type:Object,required:!0}},methods:{borrow:function(){this.$emit("borrow",{goodId:this.listItem.goods_id,returnTime:this.listItem.return_time})}}},_=f,m=(a("8926"),a("2877")),v=Object(m["a"])(_,l,u,!1,null,"2be90606",null),g=v.exports,p=a("4fd7"),h=a("b775"),y={name:"Book",components:{Swiper:d["a"],SearchBox:c["a"],BorrowItem:g,Nothing:p["a"]},data:function(){return{originData:{data:[{data:[{type_id:2,goods_id:81,floor_id:1,remaining_stock:2,floor_name:"25F",goods_name:"美术入门",goods_code:"MS002",return_time:5,img_path:null,goods_type:3,goods_type_name:"美术"}],goods_type:3,goods_type_name:"美术"},{data:[{type_id:2,goods_id:2,floor_id:2,remaining_stock:9,floor_name:"2F",goods_name:"水浒传",goods_code:"TS_ZH_001",return_time:5,img_path:"",goods_type:4,goods_type_name:"综合类"},{type_id:2,goods_id:16,floor_id:2,remaining_stock:9,floor_name:"2F",goods_name:"西游记",goods_code:"TS_ZH_003",return_time:5,img_path:null,goods_type:4,goods_type_name:"综合类"}],goods_type:4,goods_type_name:"综合类"}],total:2},data:{},currentIndex:0,maskActived:!1,currentGoodId:void 0,returnTime:0,from:"",name:""}},beforeRouteLeave:function(t,e,a){localStorage.bookData=r()(this.data),localStorage.bookOriginData=r()(this.originData),"/"===t.path&&localStorage.removeItem("searchKeyword"),a()},created:function(){var t=localStorage.from;"/"===t?this.init("加载中"):(this.data=JSON.parse(localStorage.bookData),this.originData=JSON.parse(localStorage.bookOriginData))},methods:{init:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(e){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.$loading.start(e),t.next=3,Object(h["c"])({assets_id:2});case 3:a=t.sent,this.originData=a.data.data,this.data=JSON.parse(r()(a.data.data)),this.$loading.close();case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),toggleType:function(t){var e=t.target.dataset["index"];this.currentIndex=e},_borrow:function(t){this.returnTime=t.returnTime,this.currentGoodId=t.goodId,this.maskActived=!0},borrow:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.$loading.start("处理中"),this.maskActived=!1,t.next=4,Object(h["a"])({goods_id:this.currentGoodId,lent_name:this.$store.state.username,lent_code:this.$store.state.workCode,lent_count:1});case 4:e=t.sent,0===e.data.state?(this.$notify({message:e.data.msg,duration:100}),this.$router.push("/me/record/borrow?assets_id=2")):this.$notify({message:e.data.msg,duration:100,status:"danger"}),this.$loading.close(),this.init("数据重新加载中 ");case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),cancel:function(){this.maskActived=!1},search:function(t){var e=t.trim();if(localStorage.searchKeyword=e,this.currentIndex=0,""!==e){var a=this.originData.data.filter(function(t){return void 0!==t.data.find(function(t){return-1!==t.goods_name.indexOf(e)})}).map(function(t){return{data:t.data.filter(function(t){return-1!==t.goods_name.indexOf(e)}),goods_type:t.goods_type,goods_type_name:t.goods_type_name}});this.data={data:a,total:a.length}}else this.init("数据重新加载中 ")}}},b=y,w=(a("cf22"),Object(m["a"])(b,n,i,!1,null,"d9a18cfc",null));e["default"]=w.exports},5318:function(t,e,a){},"636f":function(t,e,a){},6750:function(t,e,a){"use strict";var n=a("636f"),i=a.n(n);i.a},"73ff":function(t,e,a){"use strict";var n=a("c512"),i=a.n(n);i.a},7514:function(t,e,a){"use strict";var n=a("5ca1"),i=a("0a49")(5),s="find",o=!0;s in[]&&Array(1)[s](function(){o=!1}),n(n.P+n.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(s)},8926:function(t,e,a){"use strict";var n=a("d556"),i=a.n(n);i.a},9357:function(t,e,a){"use strict";var n=a("f4a4"),i=a.n(n);i.a},c4dc:function(t,e,a){"use strict";var n=a("0f2f"),i=a.n(n);i.a},c512:function(t,e,a){},cd1c:function(t,e,a){var n=a("e853");t.exports=function(t,e){return new(n(t))(e)}},cf22:function(t,e,a){"use strict";var n=a("5318"),i=a.n(n);i.a},d556:function(t,e,a){},e829:function(t,e,a){a("2f37"),t.exports=a("584a").Date.now},e853:function(t,e,a){var n=a("d3f4"),i=a("1169"),s=a("2b4c")("species");t.exports=function(t){var e;return i(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!i(e.prototype)||(e=void 0),n(e)&&(e=e[s],null===e&&(e=void 0))),void 0===e?Array:e}},ee4a:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"book-detail"},[a("div",{staticClass:"banner"},[a("div",{staticClass:"content-box"},[a("div",{staticClass:"book-img",style:{backgroundImage:"url("+t.goods_info.img_path+")"}}),a("div",{staticClass:"book-info"},[a("div",{staticClass:"name"},[t._v("\n          "+t._s(t.goods_info.goods_code)+"-"+t._s(t.goods_info.goods_name)+"\n        ")]),a("div",{staticClass:"location"},[t._v("\n          所属楼层："+t._s(t.goods_info.floor_name)+"\n        ")])])])]),a("div",{staticClass:"record-list"},[t._m(0),a("div",{staticClass:"content"},[0===t.goods_lent_info.length?[a("Nothing")]:t._e(),t._l(t.goods_lent_info,function(e){return a("div",{key:e.lent_info_id,staticClass:"record"},[a("div",{staticClass:"name"},[a("span",[t._v(t._s(e.lent_name))])]),a("div",{staticClass:"date borrow-date"},[a("div",{staticClass:"icon-tag"},[t._v("\n            借\n          ")]),a("span",{staticClass:"date-str"},[t._v(t._s(e.lent_time?e.lent_time.slice(0,10):""))])]),a("div",{staticClass:"date bring-date"},[a("div",{staticClass:"icon-tag"},[t._v("\n            还\n          ")]),a("span",{staticClass:"date-str"},[t._v(t._s(e.return_time?e.return_time.slice(0,10):""))])])])})],2)]),a("BottomNav")],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"title"},[a("span",{staticClass:"pointer"}),a("span",[t._v("借阅记录")])])}],s=(a("96cf"),a("3b8d")),o=a("c549"),r=a("4fd7"),c=a("b775"),d={components:{BottomNav:o["a"],Nothing:r["a"]},data:function(){return{goods_info:{},goods_lent_info:[]}},created:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.$loading.start(),e=this.$route.query.goods_id,t.next=4,Object(c["b"])(e);case 4:a=t.sent,this.goods_info=a[0].data.data.data,this.goods_lent_info=a[1].data.data.data,this.$loading.close();case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},l=d,u=(a("73ff"),a("2877")),f=Object(u["a"])(l,n,i,!1,null,"e422b042",null);e["default"]=f.exports},f4a4:function(t,e,a){}}]);
//# sourceMappingURL=book.54f6d57b.js.map